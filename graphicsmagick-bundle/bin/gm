#!/bin/bash
# Wrapper script for GraphicsMagick with comprehensive library path setup

# Get the directory containing this script
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
LIB_DIR="$(cd "$SCRIPT_DIR/../lib" && pwd)"

# Set library paths for dynamic linker
# DYLD_LIBRARY_PATH: Primary library search path
export DYLD_LIBRARY_PATH="${LIB_DIR}:${DYLD_LIBRARY_PATH}"

# DYLD_FALLBACK_LIBRARY_PATH: Fallback if primary fails
export DYLD_FALLBACK_LIBRARY_PATH="${LIB_DIR}:${DYLD_FALLBACK_LIBRARY_PATH}"

# Add bin directory to PATH for Ghostscript
export PATH="${SCRIPT_DIR}:${PATH}"

# Execute the real GraphicsMagick binary
exec "${SCRIPT_DIR}/gm-real" "$@"
